<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAS</title>
    <link rel="stylesheet" href="header.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
      integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
      crossorigin="anonymous"
    />
    <style>
      * {
        padding: 0;
        margin: 0;
      }

      /* section */
      .cards-container {
        padding: 4rem;
        margin: 0;
      }

      .card-active {
        background-color: rgb(219, 219, 219);
      }

      .home-card {
        border-radius: 1rem;
        padding: 1rem;
        box-shadow: 3px 3px 0.7rem 0 #d3d3d3;
      }

      .home-card:hover {
        cursor: pointer;
      }

      .home-card > h3 {
        display: inline-block;
      }

      .home-card > h2 {
        margin: 0;
      }

      .home-card > p {
        font-size: xx-large;
        text-align: end;
        font-weight: 700;
        font-style: italic;
        margin: 0;
      }

      .icons {
        display: inline-block;
        width: 4rem;
        margin-right: 2rem;
      }

      /* section */
      .tr-table {
        border-collapse: separate;
        /* border: solid #d3d3d3 1px; */
        border-radius: 1rem;
        box-shadow: 3px 3px 0.7rem 0 #d3d3d3;
      }

      td,
      th {
        border-left: solid #d3d3d3 1px;
        border-top: solid #d3d3d3 1px;
        padding: 0.5rem 1rem 0.5rem 1rem;
      }

      th {
        border-top: none;
      }

      td:first-child,
      th:first-child {
        border-left: none;
      }
      #table-transaction {
        padding-bottom: 3rem;
      }
    </style>
  </head>

  <body>
    <header id="header" class="row w-100 m-0 bg-dark">
      <div class="col">
        <h1 style="margin: 0; font-family: Impact">CHRIST MALL</h1>
        <p style="margin: 0">Delhi | Mumbai | Bangalore | Guwahati</p>
      </div>
      <div class="topnav col">
        <a href="#login">Login</a>
        <a href="/AccountingModule/index.html">Home</a>
        <a href="/AccountingModule/about.html">About Us</a>
        <a href="/AccountingModule/contact.html">Contact Us</a>
        <a class="active" href="/AccountingModule/accounts.html">Accounts</a>
      </div>
    </header>

    <section style="padding-top: 7rem">
      <div class="row m-0 border-top" id="page">
        <div class="col-2 p-2 border-right">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link" href="javascript:refreshData('Bills');">Bills</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="javascript:refreshData('Invoice');">Invoice</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="javascript:refreshData('Ledgers');">Ledgers</a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link active"
                href="javascript:refreshData('transaction');"
                >Transactions</a
              >
            </li>
          </ul>
        </div>
        <div class="col-10 p-2">
          <div id="welcome">
            <h3>Welcome !!</h3>
          </div>
          <div id="table-data"></div>
        </div>

      </div>
    </section>

    <footer>
      <div style="text-align: center; color: white; padding: 1rem">
        Copyright â“’ 1898-2021 Smart Accounting Pvt Ltd.<br />
        Made with Love by NK<br /><a href="/AccountingModule/contact.html"
          >Contact Us</a
        >
        <br /><a href="/AccountingModule/about.html">About Us</a>
      </div>
    </footer>
    <script>
      function getData(type) {
        var req;
        if (window.XMLHttpRequest) {
          req = new XMLHttpRequest();
        } else {
          req = new ActiveXObject("Microsoft.XMLHTTP");
        }
        req.onreadystatechange = function () {
          if (req.readyState == 4 && req.status == 200) {
            //display
            if(document.getElementById('table-data'))document.getElementById('table-data').classList.remove('d-none')

          }
        };
        req.open("GET", "" + type + ".xml", false);
        req.send();
        return req.responseXML;
      }
      // global data
      var data=null

      // if data is not available or action = refresh then "getData" 
      // It is called from html button where type and action is passed
      function refreshData(type,action) {
        document.getElementById("table-data").innerHTML="<p>Loading...</p>"

        // check data available
        if(data==null){  data = getData(type);}

        //delete if mode =delete
        if(action=='delete'){
           y=data.getElementsByTagName("Transaction")[0];
           data.documentElement.removeChild(y);
        }
        if(action=='delete-all'){
           y=data.getElementsByTagName("Transaction")[0];
           data.documentElement.removeChild(y);
        }
        if(action=='edit'){
           y=data.getElementsByTagName("Transaction")[0];
           data.documentElement.removeChild(y);
        }
        if(action=='add'){
          // alert(y=data.getElementsByTagName(type).length)
           y=data.getElementsByTagName("Transaction")[0];
           data.documentElement.appendChild(y);
          // alert(y=data.getElementsByTagName(type).length)

        }
        if(action=='refresh'){
           data=getData(type)
        }
        // send the data to display in html
        displayData(data, type)
      }
      function displayData(data,type){
        document.getElementById("welcome").classList.add("d-none");

        var tableData = "";
        if (type === "transaction") {
          tableData +=
            '<div id="table-controls" class="row m-2 justify-content-end">' +
            '<div class="btn p-2" onclick=\"refreshData(\'transaction\',\'add\')\"">' +
            '<img class="h-50" src="https://img.icons8.com/android/24/000000/plus.png"/>' +
            "</div>" +
            '<div class="btn p-2">' +
            '<img class="h-50" onclick=\"refreshData(\'transaction\',\'edit\')\" src="https://img.icons8.com/ios-glyphs/30/000000/pencil--v1.png"/>' +
            "</div>" +
            '<div class="btn p-2">' +
            '<img class="h-50" onclick=\"refreshData(\'transaction\',\'delete\')\" src="https://img.icons8.com/ios-glyphs/30/000000/filled-trash.png"/>' +
            "</div>" +
            '<div class="btn p-2">' +
            '<img class="h-50" onclick=\"refreshData(\'transaction\',\'refresh\')\" src="https://img.icons8.com/ios-filled/50/000000/refresh--v2.png"/>' +
            "</div>" +
            "<table class='table'>" +
            "<thead> <tr>" +
            '<th scope="col">Date</th>' +
            '<th scope="col">Type</th>' +
            '<th scope="col">Particulars</th>' +
            '<th scope="col">Amount</th>' +
            '<th scope="col">Description</th>' +
            '<th scope="col">Status</th>' +
            "</tr> </thead> <tbody><tr>";
          var loop = data.getElementsByTagName("Transaction").length;

          for (i = 0; i < loop; i++) {
            tableData +=
              "<tr>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("date")[0].firstChild.nodeValue +
              "</td>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("type")[0].firstChild.nodeValue +
              "</td>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("particulars")[0].firstChild
                .nodeValue +
              "</td>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("amount")[0].firstChild.nodeValue +
              "</td>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("description")[0].firstChild
                .nodeValue +
              "</td>" +
              "<td scope='col'>" +
              data
                .getElementsByTagName("Transaction")
                [i].getElementsByTagName("status")[0].firstChild.nodeValue +
              "</td>" +
              "" +
              "</tr>";
          }

          tableData += "</tr></tbody></table>";
        }
        document.getElementById("table-data").innerHTML = tableData;
      }
    </script>
    <script>
      document.getElementById("page").onwheel = function (event) {
          if (event.deltaY >= 0) {
              document.getElementById("header").style.display = "none";
          } else {
              document.getElementById("header").style.display = "flex";
          }
      };
  </script>
  </body>
</html>
